package org.swasth.hcx.controllers.v1;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.MediaType;
import org.springframework.mock.web.MockHttpServletResponse;
import org.springframework.test.web.servlet.MvcResult;
import org.swasth.hcx.controllers.BaseSpec;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;


public class ClaimsTests extends BaseSpec {

    @Value("${hcx_application.api_version}")
    private String api_version;
  
  @Test
  public void check_claim_submit_success_scenario() throws Exception {
      postgresService.execute("DROP TABLE IF EXISTS mock_participant");
      postgresService.execute("CREATE TABLE mock_participant (" +
              "parent_participant_code character varying," +
              "child_participant_code character varying NOT NULL PRIMARY KEY," +
              "primary_email character varying," +
              "password character varying," +
              "private_key character varying" +
              ");");
      postgresService.execute("INSERT INTO mock_participant (parent_participant_code, child_participant_code, primary_email, password, private_key) " +
              "VALUES ('hosp_hcx_955522@swasth-hcx-dev', 'payr_hcxmoc_903588@swasth-hcx-dev', 'lagertha+mock_payor@yopmail.com', 'Opensaber@123', '-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDAQLG7dTHuSE1F 8L46wS84SCU4Pf+ofSB8/h8tlyUHCw2SmY3CRZ3Uz1Jtw87UCdEvaSqs4YvkdKIh 1Nt04xpunUufUYNx6wBx/S/nuG7zcUu+bQeO1SpeEAA6+4HvnAyVBc+YCctnyREr Pgigs8MJG6dMA2rEap1na8VTrVN6JNNhcJxqnCyMoZ/aJIrmRxMj0Eh55LC20AZh jkxt5q/12qarpc/0ItQ2nv11fucojVVQyQGBaeqULVM9fGXbtquLXnRLJWzTLuSN Zk3Z+NpZZ5W7gxyBsxGTc7ccWp5edOxMXK3wELxsqirT0EOIz2ZMEYVbWrCyxfGC WYGUGRkPAgMBAAECggEACRAjsMweDfcfmW/3b8qioLsZ8hROJJG9gdby/lG1P6dA PQx7F9DzV1BsuNr1uZ4628rP5bV+REdRS1n+/HwmR1en9HtBwJGNBFKkuv5BUL2j DfeS1yNqa2PCtwUbQ4HuP+o1tpujmKFsa0bx3i2LQLcqhFVW56qFABafB0pQ+J2F 5MIgoS3e84Q/4oHYhxcRCgINQRoWKkqLGdAMg83NGe/G97PHGW9PPG9AQnfVhqey adov6rO/VOhbEYoKIwBq4G2qFnq6GwxDsx+wKl7SMVIwJzk8lRd5IaCGNscGEirU f/1PKxRT5WR735wyFyqLtSATFlrvH+sIiKsYR0PRlQKBgQDewV/umGidbm4jcmYR PFW53Ipr05lz4VNUOxdI/NIQ5jNfwjTE7Ep4R2xWycgzFwtoYYzWOhgHfSEcQ7KH 4z7w5Oe5CO+NB9viTxsrRx/kc6KU5cr3iqYCQzu2IaaVL2n6a0dDWR1ZXSGckKCf RWENuPkU9BAMn5LqEbcxVkSp6wKBgQDc8e4tMef6jpX5i8UEtd3y0HE302I1opfM 7Sdl5KVYsTOcTVobYM3niRKGtaY26EP7JCI2D0rCGS/DpDmsf7v5uHD4pZ4whRGR uhj64NIzveG3goki/ZerFZTc83mBxcaSBg48XL2x4oy32d0YXRC5IqEZ5vAIo7JE PlOZgKZAbQKBgQCVlVN/XHc76NErGoIx5stGYTPOzqxIZbJYaMntKGFEGeG71yUq a+ZiOMwmx5+Zt0rg0EkL/rzuInfejBNSLyawC3cUCU0b7oAYy7hZ6owfFAvEYz9V 1ZQ/BrkNSDGeEtXe5LVZI3mS7fhJM9G4wpU26tTQ3kf8whec+UKEbgLz+wKBgH1H EG2/5nFDd/ZPMh9Bn9+WIRwuV3liAADKV5SG2No5X7I4iecMNLQcHM0VInHvsNwt 2NgeQ51a+qJL9AfDRaqK0kOqZM/OI/AlPRTDdWyxNdL/yRJ2CBGR4x6FT1gt9DHI DTpcu5KpinCUr7Co1FqlMAOn1mKPrvzS+kQHljzhAoGBAL2Ui1c/qrX9ezggR78D WTK8u4QkvSdOoSDVbOes1FYEExHWh8hvRfO4PLTzlK58MJJnWj9hgiMItWzI7Iic pOEsHqgNl19VjdtKEloRAe5HYuC0pTTNTXo7qhq/De1wPr/lM82jofNXzpSpDetU 43Q9DXQ5KNiBbsKedfkRhJdY\n-----END PRIVATE KEY-----')");
      postgresService.execute("DROP TABLE IF EXISTS payersystem_data");
      postgresService.execute("CREATE TABLE payersystem_data (\n" +
              "    request_id character varying not null PRIMARY KEY,\n" +
              "    sender_code character varying,\n" +
              "    recipient_code character varying,\n" +
              "    action character varying,\n" +
              "    raw_payload character varying,\n" +
              "    request_fhir character varying,\n" +
              "    response_fhir character varying,\n" +
              "    status character varying,\n" +
              "    additional_info jsonb,\n" +
              "    created_on bigint,\n" +
              "    updated_on bigint,\n" +
              "    on_action_status character varying,\n" +
              "    correlation_id character varying,\n" +
              "    mobile character varying,\n" +
              "    otp_verification character varying,\n" +
              "    workflow_id character varying,\n" +
              "    account_number character varying,\n" +
              "    ifsc_code character varying,\n" +
              "    bank_details character varying,\n" +
              "    app character varying,\n" +
              "    supporting_documents jsonb,\n" +
              "    bill_amount character varying,\n" +
              "    insurance_id character varying,\n" +
              "    patient_name character varying,\n" +
              "    service_type character varying\n" +
              ");\n");
      postgresService.execute("INSERT INTO payersystem_data" +
              "(request_id, sender_code, recipient_code, action, raw_payload, request_fhir, response_fhir, status, additional_info, created_on, updated_on, on_action_status, correlation_id, mobile, otp_verification, workflow_id, account_number, ifsc_code, bank_details, app, supporting_documents, bill_amount, insurance_id, patient_name, service_type)" +
              "VALUES" + "('3730d51b-7371-4d34-8641-a005dadd2286', 'bsp_bsprol_846730@swasth-hcx-dev', 'payr_hcxmoc_903588@swasth-hcx-dev', 'claim', 'eyJ4LWhjeC1yZWNpcGllbnRfY29kZSI6InBheXJfaGN4bW9jXzkwMzU4OEBzd2FzdGgtaGN4LWRldiIsIngtaGN4LXRpbWVzdGFtcCI6IjIwMjQtMDEtMjRUMDU6MDI6MTcrMDAwMCIsIngtaGN4LXNlbmRlcl9jb2RlIjoiYnNwX2JzcHJvbF84NDY3MzBAc3dhc3RoLWhjeC1kZXYiLCJ4LWhjeC1jb3JyZWxhdGlvbl9pZCI6ImJlM2VjYjAzLTgzMGEtNDUxZi05NTNkLTZjNjU5OGIzNjhmZSIsImVuYyI6IkEyNTZHQ00iLCJ4LWhjeC13b3JrZmxvd19pZCI6ImQ4Yzg2YzQyLTEwZjEtNDBlYS1iYjVlLTZjOTdjZWZjNWE4MSIsImFsZyI6IlJTQS1PQUVQLTI1NiIsIngtaGN4LWFwaV9jYWxsX2lkIjoiMGEyOWVlMTktM2ZjNS00OTU4LTg0NzUtNzZmYzA5MzkzOGIwIn0.ZqUQ29KBWzeoQNebFdsOTrlew1aM_EUklDGcsfGK506XVscHHwQniGaaAkF0qlmJ5OXWOTAnWPlCu2Ndy7TpxzkQymNRiIISwBz7n-tcIgNwWUGdHDrSFb2E78rBPe6AtI94L4FqZatDJmRuCBt-RPwoWXURYeNCPIxTNQ_kljc_qPieyy8EjN-n3-AX5UurEjC9eDqhGQ-z4JKwSf7HlrFj7Ejge7orZFNmIjwM7uX1Gu6o9Hm0QC5HoQGOwD7_X5qLRDzSN5NlWcP2ebCZ3qrcDiswAfDDFF8qqyI_-yhSeIXZNzfBBsCkUJCqoOd4kh5RJc2gEfTfk4Qc7luz0g.bglbGPUzNezaxdR8.QcOVgIyd1qMZMIJjB1V007uXMQSat9mV_PEKLtu5iu_fwtrMxKBO1uG3U_wSHO6fAdfmurUvXSRvG1GaQmwZniF0n6Z6eBQDwwMtoNprJgpioQjfkAv_6i2GOp5Ix4TMIp3pH0ZDLAC9puZGaVXjiuYNgcxZLn6FUXrzaEjEOgxYVwrLnBM5XLoNtKPMacQZ8foKpfUDKyenX__JmxC9OGL_EehGIv3taGXfzrWV8rCGyzA1pzm03mv1g7L18JfdqY9RcxJ--WwWHp62feSDjXaJdC0pxXS3rj5abisXZQt7SKIRP1tc0NWHjvkHNCpsEqGcawUsIku_IJuSGAx5iEuvDE6yxgzLp8k2Y1QANW4_vmfkcacpHfkpdg5OeUMTVBMzzuklRpcmf9E0t0qbg8jYG7G5C-YE8Aq7xI8moxN9cRJLpiGohdqhkBVP6IlDKXvlD3dQDRz82VSXvuwah-AKNZuzIBiwQgA2eMIzgSAOp6msIltkpKygL4B5pzASjrVaRPvE0h76KblfUdnRYVc2KpxhK9BiojNcms76X0a2Hvre3erKqDislYso8TNmtEirpnn0cB26tgvfGCyZ0cWvWZOgwqcze2NPUg_ngpPUNXDzqP5MNW3ZJCepDKd5WNZqHy1H5Aei5FBl6n0qP2cNlUt6fezX04qT7lK4XQ8qoiwSEmXqYdmKRMJG-Z46czrLAs4WIeiIq9MKzkyudf4V8UDldEf3VYJA9-g7r8c_aFy0rIsNnW0YGu1X5ViJWPBhVGCB1DDyVXFRv4AFfybn2U-KHCOA8asbV3Sn28Fb4-_j69hNM-x_d1bem17_jIx31Ib77_73kpn7sMcmh59MwrYwUY17tpOA36NR7dNljImjj_IoykCN6PnNSFw1AZHtVMVFm-qPi6oucippocuyJqn6LMpikgQ4aTa2Y7EcGj8hjoiG1taGcVFtyOsHlf_484FzXpud3Rv_6dcMRi8hUpVXj3jSs_X2Sjan-SP8pW5Qohog7HwhXaefPxOrZI3fjugjDsDO6n994KqoHcZs5nGQmCF9ElZEkObs9j30D8f42AJWrI7cbWY5fdaIYgmBDDjFdi3hewpML3KmegnCN-2_CSm14NlfNBNFg_zRunVhK4oMsYpU1qykE-_kl5n8W__jGERZcA2XKZbM5_TV5z5AqWoAqwk7tGL4IMP6LLf2MC5fCuZLb3Y7yCFnTaShZ8kaE1BQ-U-bZSJfjqscCGjoMZCuL86VO7Uo5eYNaS47zzuzLdSc8wVsFEgfJh5wzqo1P7RAbZPIciMGDWa0YcKFVHAPX_hAWqvTttIXNdTELTf0F-Y9mB7k-A7nL9RRws6GN3OULmrSsozTCc3F5wKYIwOT_gN5PDGUERbWkovLNq9HgqufJGSQWMO4HVD3g-EeVFS3TqBRyXqlMLRbqTooDCcrbESdd0jZBPsUmD-TOzW7Nj9ZxClbBEZZzhjAftj4YdCxHNjrR-d-fYJ_W0VkaHGye4lZCisp9Pijy4vWCwkpUNayjMyFyjB9Gs740SxGM7qFxYwRQBC2ehq42IIm5DCJRBwYphsdXzl2Hab53s_9Ft0TKaSMVSVjjZ1I1mldY6OkTH8iH3tvDkqodvL1QheWjflk1B6_tONE-jCBwqnRUgnlATACuj-eDu5Wk3PHKvCXXDODndCfPqEHTRf1dScqWJfpbeTzt0feHGhVWyBBS6YxaagpMolf2tEjQTzudTBardNQ8nO7CH7ONkR9yTigJGAt15N53yLBb0jRe8in1P3_xCs2z9J5RNE1T9SViVjXxdkR9uU6A-78z3C4f9tlX5O9SN7SPlUqqVSxRAmXg7Uv4MaxxUjMm1BDqmOP7fkU-EYd1v8WIhO_gkICvfybHSjQ04FS03aVSYevhYNcI2joQo8STF3epxvhfO9eEpCW5QJEiPQrkM3fB3Si06GuPxH09fUce_TF0mCR-Uq3YhppUVXoOHE1iYke1mFkxz91uiH7xMvud81BX3lFqfuVFfdVyDziJrwTtSgCTCEqPSjmaIEJT8oKnILVeSN764vbo74jQ4obV8l1o8tk6sdqfJ87KoHxdnyRJSdiJ9RdZQJNVH-tSWszBTFYj6sieKVhX0sgMeb_AozvLxdDSnEeYogn8v-0EbC-_uSmW8KGId5DlJAIu0ehQxSmz74EthjwrVECQp219EyMgFwLTzOjVIeoeOLUK0svJZpoFYY2xrymFwa1Ah2arDxN59Y5vdo3GeOrAbuOsy424X8GnKC5jjlGXXISgoNvTx3BEklONGAzMmZI71YuCbQ9sg-mWmvHaf0J1MX3ZcXBr90P7SM-mSzmcaZA08mzus7KV1oktaQiHL1SIJhW61v-kGZGTKG3C5BhzgmLEKCPCbuwg0kYm0ud7yinGQcSTHDi1k4SAhGSsxaLMfL3ogkLryVcRU7ARHDbY6lqlsyermEnhL0mrbpRXgvZ3vB4hSerlaqcDJ5yjj23mw0xNkHUUhHNQzOBlTSJgfw2YbHpBRAj0Yvt3nP0exz1WF2JIj9cvU_qGC_b3CseVVA-kTgRA81QwSW4HDJ2bU-R1qnF0bUKfkOlXkLIBE2Hum1bB4VzF_ZZQ3USccaKTiHM_WX2wCbsWaqlkaEPP3TnC3PB7TqamKj9XoqUuCZ0Q2GjVeNZTifn9ImUPtIYWbBM7I9fSfTc6TMDgkMYI8SrdZMJyjDGwNsFlN58tj_SahfPdi1GstE6Vw3jNhdPh_xcLcxY36CZs8lHls5tkLnY-dfy1PYtIR75riyskqUTHKauuM_iMM8B6laZLl1orljNPKIZF8BLbOkL_9A7VpHgIgdy_ruHYCNC65auQf1s_6TD0gXdxba6OBUhKIapnFVkZ9wghGdzGcC3hc1N9YFDiB7C86VdM2gtyiapz_Srp4MTqOi9a2dyYU6G1Ba-mMOdnEYOtGdiEJQDPjeSfnNDMuBhXfrFXcvTfmj2X1jasg4E_eV0aZAqf3jplivgzpMy23lJ8j5sU-bEmp6CiQTrc0hU0U98qN96n0R8q98P1H-eqxAdNIcv5YnNednRDzn3cLtmV84IiYhartQpO89jtADFGPG2X5LTocA0gpl0D9s2BUR7fiAtwsGFtJRgY43pbKQTaGLWQJcUltDV2EnVOf1dw127D57Gz5MQFAiu612LboQWlhdWdERzjtiLzgpY2nU7I0kkBoPQHWxqqtQQlOhTe-3sC_Qg1K-8j-gbIAyv_RLgFt_Dq8TZF8_SUwDDEWvzhHhdnBM-URuerHTODEW_sQZUwPSxqilXsZ_Gf5EXLEIqnGhXj7f4aFn2i3LTFss6A1yAfylLWvr7U5DWAtqKkc7dcd8EbRamWj4Wnhp7ES5xfP02npqsM8CxaeL9Yy1ema-gIFqiLilVDGFbg4pXM9DPBG3G5ctNzcWgR1UHR5Nl6SRDIAgdcAvjKGZCD5XVkUwL5VnVBQhyK9NmNMKLxfNwRWmJFHMB22l33UTkPg7AUmQ4URAPDVfsltW0topuUGuXPQ0X5R6a39DZduJ2uNQsyS5u4sBfcZzZt3NkNozilnZVVMFZvGEgpsopn0JhCjFWkhV76WkpmkDcF7IxGJ5PcUA8t9iAxGiP935mBV0Rgb9CP06OEvXl1288b-6993OR7R4bQArVnoGawbPWvIRX88qurzzTjtu_bmeWhuFJ43BwAxIQUO1Rv14MBTb-H1LdXBzDjRo8ts05Z3YzrxwG0L3SPmu_PcSLqQkhDImFNdxEQXWPyPig7vSPTDAZdJaGCZaHq3n3O37SZc9u4OU_xPBYWbVuRq6p8N2YAj9ALHeVadQzxxGPoWhJBqmvkCUbTmZkarM1eEMVbgLErnUMWmlUUVMcE-yIfj8mc0OYuSCZrz5HQx8b71WfZ5fxLHxkpAFj1Ol0TuUikHPlt4EdWNByfbTihDQE0d2Kbgi4rPQG4uZc7-6xiULmCZaDg-7-B4LfA0WqMpbSfH5Rg7EX8CSKaISs2Pb_93WKou0VKs2SUAOgUt9PhQU5Yh-i8O-ZV_syH7Cz0PgA1U3IrSi5FVuzdX3lJHSyQ4CRBsBdjH58w3dK9V1tUaNZITY_mXioS_Q5Tj6ijpJ8bDkpBXTnyjfFkinyo5SRLYn660pOV01lbgJAQp97PkXvLCmMDl0oUzCb86BhAvAhrKC-RhjWAqkJgc1KZeXYtMJU638EXAVpfhTQfRrJVDF2hUYlOtnuCFEa-8lcGkyouvPLPhsU8sLQV14QS7GkiweyPu0Q58hSpXfIZIuq6XveFId98rOzBnbGtie0hQukLB_vnuG94BLXsBdEY1KSIyHG55oCriafAEDy8W3-htlXmbxvjvxxoraqO-lhECPsbpjJe3Qo8V3ICzWGxDYe_2iQVb7K5K_2KuhIWl7woVxUWuxAwG307X0nW_-HtG8hkKMeXebp1IqwCH3AE97h2QQjpELCz6V5ThmjFn0jwJ493-wm_9onnoF1tqZGGtQ7CqBwMFSEZ2biYMO3ZYi-KReAGuhNOYiK7odxNo5N6FyWo4jqt157bYwoIJSc6yIv8I64Vm4aKVcww5I1ca-MdSq8wLcZfeuJzRQlPPoIpRs_gNY9koBTXeD033-wnAJ41NwD4I5DFL_BKhLZCF1BezwxWaHYOT5QEV-39XYJxwCnu_WWkyuHIIKIsBXXgQQ-tKYhyS3SMX4hzxkAiShOeZjD3tRQaadVlzYICd4MfrI_7Ihb9iI3JKmNciP_Bz91W9rNiCkkIOTc72UhD4WI9gZlGVV5HF3oMlgxResnB6RqlIIUIkRTWKHgQvve1YdnUkxrI547yQL27bvzlvMxgy5HsyjtJeUMYSHkqOvbMBwW_a6KvHtP6jQy_jwytBySFJpo6wgWrUEezHFZm-EHDdKSkygYGf-lrQ8Oaqge_pF-xtRT4RM0MbbEJgHAriFIBIawbVGVPGoPsPa6WXPU2jfpocZhCvPGvuaXriQNuj-pEq-y63crgoOX3ZYTasStriGtUbUslPA3WNRSSUUqYM8jxOVx8gI8QUQta8qw82-QP1_C_hxOxzeSV4QNkQicxS70-RZOgtGoytoL-tLi7EYlHyx-8_N7x2JKbhvmqY0hXlZE4yYqm4meB1uZrBe0q5c1tmHCSVn_aFBR6Og38isNoOw1TqSoaCAf9VpComgAVHaioWS_PrjghzBtZhZJYMO651hpEyyghyPqk8JgOoD9T9lsYTZsr9YBdbMG-75LEEPfx1EZVRyiSE51ni-cnckW-AzTvyutnPLLoymfNY51fC4myz7zqjAyn3JF9qefeFGhJlhWaVZ967oO7FHFnW58ZGAIRh5O6pRdjXVEAlkHbT2u4bWhE4Ay4_ZDeSSmXJT-20oWf8L0lw2V6wyMxzcYfpuSxzHnpu6SLex8MO4ub6jRCVwQqOzTzxVyOZAQKM4sbtx4H0VgIx1XSn5v7Gn1QZ4aryaeZwetdWNDwBrm5clSGPYeAlEqTV6X3FKR0CpOdEH1_s3HRhcX_F4sdW926J7peWT83AnmL7vdFtwaLJTPZl5pk5AQyMeR0oPLeroeZAsK9fOHdC-nHZFuHgxFxmpoc0hSVk-AqP81CWy6c4YomaLuOcWrQ6xGOMfp0ZIkGtoNDzqDx0UWe1TIkjGEL9mRv6N9oMFAiX-GkmOavY68EI0oEeoGHCerwlIz1PKi5wgfUlQ_yFYtRfkaR5q2GNeVhtBT9GCcdEZEfzHgWRB8vPqEPO5oIQfmBHI_VIP1Y_cBTNQxb-PHS6cE2Lyt-uCxRF133vHIiSzLF08P8RbStug4ixMdwMXfLh9O4BllR0PJUmBjM0nggcsp45DEUks_z3scrCsNhWnudWssYBO39JoT-npSdgYH-ab1HWIp9qb2wTlhr_RxmZJpotrm0rXhMrouvJr-RR8Ybi807e4tmyOPzMMeDx9S7x7RAjJIIoo2i4cATQg_YV0_rOFyJSuGMYIqkPg-2P9DdfFjbzqDnjOgjDefib36NSojB94qfw04fGqQsBGpq5f6oJWK0tJhCImo-RxBa8TXlkPMwKtrppcGIrv7f76Jw3mdh6Dkzk-8zkCZuAcC53KjNu358HqyKnNVJkZ2emZtEFwj7UNgFrxh4egGRbZfBLaS1QLUX-NQpT39aFK0cKVtDpoYmFv7MPzoOh89X_dyk0X1fnDPyA6J-x2y1botExpVa4Kzi1UGqAn7WYUuIM9QabVCMk5xMlxfpY-SQI0H_ErqWJFt1TPH-OwvymbgRGw2X9TyAAyze7i2uAx1jOugKXjGaECB_CJyf86My1Y23NfiibqY_zwf38LWYCTG6nfr0KbUAu_bSnabnfcOf9vbksghq64qZaylcIBkd1szKYiaJWJihdKYMFWxulO8vZ8dXPNwAJJr8ZK49zuAJTtkSFuUg7H34xiCFKSsuLkgy32yyEs7odVBvjVFFHiwCgj3L83xrkRn-U1SvtK8qhzZHs51oAsgGFjdr37w35CjQCFH-bjMEyZGhyegXzfrnMfK7NPpkhAz72uifDgvYRjuUoNtCq5yp187KWjxMVH6ZfS6ycR46B2kIBCOcO3j8MGnSEIapaqOai9spzMhjxQvtjAN8RWEvAzDZwY9sqKqDq_eq6XVVaYA8AvTGrMB_tQWmhME9WY6fn0P7wh4Okzak-skYlyJha8v0PQzBRjUFVm77GzpjO8SeTeFfA1ZEcFTIqNpMi1pXQkgPmWoLxgXVI2TBZkkSktnAxundpFQqqfqHN9g9dnQVjkbt7TVyVfesUQLKXOOEXP-7ba6LYTc2A7uMbCpyQEKQkGE4fRabFDyqIZe4xm7sUpxlalWR4sNqJdIAwCEbsqVwVEQ9Czb8fzP62bR0SSW2ACikDltvVqWSOT2le9lcCNDmdHrZuBMcDkJd4jp-xpfBuUjUum6x5yjAIcJ6ybF8dPQClSAei3hNglnfDuqkVWPnmOy0-qnFb0U-X8uLAQg1FQLr2y65BfvGTtZIREMWigJ4FK5EPqtiyXsD7MgdA9CsxcWVXCSc11FnsVIoblIDS_DdUdE4tc7JkW7iQKT7wCe4WGuA523bRU_YtD4WHhNpw1N_qZn69f_SsWPIE4Hd_rRyTgj5dtbtuUtbljxqcxd1pElanNjgC8eBZ1ai2n0o40n6g3GPPYczAQaFQ0TY4Io1yLR-iLIUWP1UyZGtXfI333Gff5Tbm8WNBFJSdbGYXBqJgiVIIijmzY_MBYduWWXrKeErkKlV_EFbzQFKusQDtoaK0Zc3y-G0EjAblRybwGw5I4AdBjwwDhWyhNraE3r8OraKCL_gHEO9iuqWz5Hd5qNp5surAgC6c120k2fb8jhNFTewXXjbMfKTKOLlJ-H1A3g46z2h2qqmKfwLcrfDkGU5rdxZdlixmLDjTZjUUYSwLWSKP-kW7TIUAaa38Bbs5c2c7KcAjTXJQKXs1r5xnBGCadvDFpc20FAbIldiWi3SJWVpPKVIee8Ib7O7dvRzSl8rny0p1H00fnCeO3pgVWMpAjnaDak_nD5jc-IS8ioLdy5RYXu_u4j7Bc8ADhsfxWJ3z2tfUuYj91s9trAaTXpY91va-e5tXjds0CvIPxkhUkmjYuznjCb6veVoaFE6GwocUZtC9ZAmmwE8vH-AElYy0SlriNk7vOU8DgAHJkrEbZqmj4KumjSRboSNxMcWVsCDH8-OivfbWMKaAUghqSAqnwrMvGkEZXd3Z0vwxyWrk6YgdVzLqJnm07yvfP8aq2yEw3tKcYsIXxy6iN_I4BzWmX9jVFrd2AxIE4XvGwKXcSerbvFsyPIzBiRWz8EXd8ojGWF7GdKgaUhRc_HmwbIQaDrh6orGXAXHXT-mUkAFPgALsuN6n29S8LUmbrg6rbqHG06mruP3-0iEPu5yMDFj2jk_FZGllBzRhYqe7Bfbp_burXEIHFblkoLjTfbeNdh-9rFutcYCQjj26vr1auZ1XR4-uiKuYs4XJrV41rs1-vDzaU5QuC62r-EYi0BnCNyEY3HJTkC1YxNAjhMiBZYzKlVtg5av20KyQfOurTurDsDn-3vomWrKlRop9jREIMVOaujOJYCKM-4P-qOs_FljyKfjMbF4s5k35dgP1I6haJkep2gN0bLQLDGXix553NsuvpKxIODCOpGWIgRE-3KqWblf2BycUp64ezacp_3esPu3WBJZbJr_gH0Kh17xV_HzH_6m4J54QKJb9b8bOvOLIEiX45mJKp6q3iRwucWESLTngrCnf953ZTDaAVZPBiK3j19cK2yseGd_RlNIt-vAsfNR_41BMCd9KOngkNLX2lWHeSo_FOXaNQUh-O5vgjGWqRD-0Pzt6r5u7ulPRkU5VekA4bzjWOXO7DtlNONcbTDTApRWvmXf2AtFh2tZM1URoTz8R2DjHmr--rpmfhRebfwZU_Bhuqom1vpbh631od9YcCpb6IEdD80Uy_w6T5HVylql8YrLengz2kGydOlPCYLyabTFzucOOzAY-fDOsD52057-eYeQTkt9mKtb3lDVKZVKBYQgpB4lXPX3j-ywEUfqp1t1GlWVRlCF7MQDxZumXP-C3vcYHM7Pui_0PTv9qDcr5o46_YWLnPixYbpC1G_l242V68lk_8IXVuH3SHIQRxF6MkdbqEBnbYAzekE4VenZPKe21e7X8MErr6qoQSTYf8Nhd7152Fg5YEmb7QZLA4oauLzm88OJf4xExEIswB50eERucZgjAszdoeSHHw8gsoLRc1BB-n2fV8OtiyBhWzs8B57Gc3FkeakVRHHsOPiH3cpGiXwUCjiNlQWzJnGi0BiY-V3DJX5zbu4cQbNqkaRJghI0dZf8DiBNX92H3gv-Tb6GuHKl3W3wniG_2v8rHZ2_qRZQLakjyd9hDQCajaX7l6m-KhrSBViSIYytl0vIJZRaPAu_xaVk3jz7QdWzgTO23zC-VDcW3ziRA4YX5oeY-ZjsJDfo55S78YrhcX1qyYpAXmKsG23cKRxB1Fee15kNwBhTHhQ1YQFZ0gspEtYBC1i-5UcHu9oh833cutFa0UU15ZkVsKJB6XvbQrkV8Q1m3fLfPHH23hI0L0--o_b2p79OasLm7SuZF9UhvShCjRIQSh3Huus3gjmpwFpISqwAHwfKlFcx0bga3uZvCuo9v8Y719-toVb5zqNkrLK9X5WTFL2qaWOx7_ybAhMFbcPlZIDiuQnoyzr0xDHr10yHu-UidKSIYROFTu7W0gktM-tn7kZd_PbMd38AqYAivurV69vm7n4IGTwPZwxq_x6GJJX17Y8RCXlfsN7vjBkcQDx-sSXDlYbaiS0cFrIo5msJmRoS_ekjaOkxakdxki6lglUpZVhCa07sJeK1P2ewAsOFc5liVTDkEw52UTC6kxKGza9yVOwJECfAVnGPWiPxdEOOLEWjgFU-bRDm7Kl3X6InszVE7uAEGUZjS7pTrOsDvTzv-GA0c58NnGnYrR-LlslQfSrWLwvyKao5gxIHO_mLViV64hOJbl1FmMTWTIvTxikj7drXBMAUA6FO6akimfAFYguThRdRPnG1MOSJmQIN3vSnZ86yPFrLfoibNRzdMIVINQEWSZA3l18yvILGSWsc8wTXdVHtiwSdQH-ScbGCYHRopzfLt3EXUL2_TQ78lzMeWq3bLoPR0vDfasj_PUolSvNU1JLLJWCG2LFp7pUcLbDxCpmS5lixzCzG2VNBOORXEN_aMjhsXhauDLyLELs2t-BMnN9_YAnHp3b24Jpp6wRgX7GDwGS93iA-wmMEhhrabDdd7ccBLYQMInXB6TflaPpg7-cKdopnUVZoeumQxhCsmj-gauicUr17R27VvXKCyoohUFHFDE12JiKt1d9rg9DhrzvikmW1pXC_Ofpgj3O_zrqXST32V1pJfXHe4Nenx9ApbbEUok_s1BbMvnYTOB_ci6vUu1YjbNN1yoIcsRhURfosHrEoAKHp1zzZSq6pBpT6xImxTvYZeRHYrOihgwFS5ETcwes1jh9sL5AuNh-WYDYLU8suqDg0wLxq6VATgk3sJ6g5dL-sRXH3FjOeGGm30cB63KeJ4TEGQLkIcNePbCR3S_VQRH0TssBObobJMkYKvSKfmAkvMbq0T8bnmBdd16IP5qjeuC75gquT6rRBklf2x6C2ZChXJgULm4CvZo4hRizg3DPFq6ywt8iEcLgSJQOc5ZHYL_L-WLowpX-5cZwhMQ8bjyMjUgJjWORYW2NSA--dy6wtHf4qJ37qdzaGOdgPMWQfXzmKaJDVcYHIhkHZYbcOuNH7JZmBJthLLNNIjwK5CTvPDGR-KlRH3sfvxWzo5pCXYF1F0EC.k0iJtq4ztHTr_7yf6eTFXA','{}','{ \"resourceType\": \"Bundle\", \"id\": \"3730d51b-7371-4d34-8641-a005dadd2286\", \"meta\": { \"lastUpdated\": \"2024-01-19T10:17:02.570+00:00\", \"profile\": [\"https://ig.hcxprotocol.io/v0.7.1/StructureDefinition-ClaimResponseBundle.html\"] }, \"identifier\": { \"system\": \"https://www.tmh.in/bundle\", \"value\": \"93d2f78b-897b-4581-aee3-5ea9ccf62e45\" }, \"type\": \"collection\", \"timestamp\": \"2024-01-19T10:17:00.421+00:00\", \"entry\": [ { \"fullUrl\": \"ClaimResponse/fe4216f5-6c38-4b8a-9664-8e090d9576e2\", \"resource\": { \"resourceType\": \"ClaimResponse\", \"id\": \"fe4216f5-6c38-4b8a-9664-8e090d9576e2\", \"meta\": { \"lastUpdated\": \"2024-01-19T10:17:02.570+00:00\", \"profile\": [\"https://ig.hcxprotocol.io/v0.7.1/StructureDefinition-ClaimResponse.html\"] }, \"identifier\": [ { \"system\": \"http://identifiersystem.com\", \"value\": \"b6bbfee4-075e-4c48-bbd8-7e09fa1bb54a\" } ], \"status\": \"active\", \"type\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/claim-type\", \"code\": \"institutional\" } ] }, \"use\": \"claim\", \"patient\": { \"reference\": \"Patient/RVH1003\" }, \"created\": \"2024-01-19T10:17:02+00:00\", \"insurer\": { \"reference\": \"Organization/GICOFINDIA\" }, \"requestor\": { \"reference\": \"Organization/WeMeanWell01\" }, \"request\": { \"reference\": \"Claim/CLAIM1\" }, \"outcome\": \"complete\", \"total\": [ { \"category\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/adjudication\", \"code\": \"benefit\" } ] }, \"amount\": { \"value\": 80000, \"currency\": \"INR\" } } ] } }, { \"fullUrl\": \"Organization/WeMeanWell01\", \"resource\": { \"resourceType\": \"Organization\", \"id\": \"WeMeanWell01\", \"meta\": { \"profile\": [\"https://nrces.in/ndhm/fhir/r4/StructureDefinition/Organization\"] }, \"identifier\": [ { \"type\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\", \"code\": \"AC\", \"display\": \"Narayana\" } ] }, \"system\": \"http://abdm.gov.in/facilities\", \"value\": \"HFR-ID-FOR-TMH\" } ], \"name\": \"BSP Role Mock User\", \"address\": [ { \"text\": \" Bannerghatta Road, Bengaluru \", \"city\": \"Bengaluru\", \"country\": \"India\" } ] } }, { \"fullUrl\": \"Organization/GICOFINDIA\", \"resource\": { \"resourceType\": \"Organization\", \"id\": \"GICOFINDIA\", \"meta\": { \"profile\": [\"https://nrces.in/ndhm/fhir/r4/StructureDefinition/Organization\"] }, \"identifier\": [ { \"type\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\", \"code\": \"AC\", \"display\": \"GOVOFINDIA\" } ] }, \"system\": \"http://irdai.gov.in/insurers\", \"value\": \"GICOFINDIA\" } ], \"name\": \"Demo Payor\" } }, { \"fullUrl\": \"Patient/RVH1003\", \"resource\": { \"resourceType\": \"Patient\", \"id\": \"RVH1003\", \"meta\": { \"profile\": [\"https://nrces.in/ndhm/fhir/r4/StructureDefinition/Patient\"] }, \"identifier\": [ { \"type\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\", \"code\": \"SN\", \"display\": \"Subscriber Number\" } ] }, \"system\": \"http://gicofIndia.com/beneficiaries\", \"value\": \"BEN-101\" } ], \"name\": [ { \"text\": \"Abhishek\" } ], \"telecom\": [ { \"system\": \"phone\", \"value\": \"9620499129\" } ], \"gender\": \"male\", \"birthDate\": \"1960-09-26\", \"address\": [ { \"text\": \"#39 Kalena Agrahara, Kamanahalli, Bengaluru - 560056\", \"city\": \"Bengaluru\", \"state\": \"Karnataka\", \"postalCode\": \"560056\", \"country\": \"India\" } ] } }, { \"fullUrl\": \"Coverage/COVERAGE1\", \"resource\": { \"resourceType\": \"Coverage\", \"id\": \"COVERAGE1\", \"meta\": { \"profile\": [\"https://ig.hcxprotocol.io/v0.7.1/StructureDefinition-Coverage.html\"] }, \"identifier\": [ { \"system\": \"https://www.gicofIndia.in/policies\", \"value\": \"policy-RVH1003\" } ], \"status\": \"active\", \"subscriber\": { \"reference\": \"Patient/RVH1003\" }, \"subscriberId\": \"ABCD1234\", \"beneficiary\": { \"reference\": \"Patient/RVH1003\" }, \"relationship\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/subscriber-relationship\", \"code\": \"self\" } ] }, \"payor\": [ { \"reference\": \"Organization/GICOFINDIA\" } ] } }, { \"fullUrl\": \"Practitioner/PractitionerViswasKar\", \"resource\": { \"resourceType\": \"Practitioner\", \"id\": \"PractitionerViswasKar\", \"meta\": { \"profile\": [\"https://nrces.in/ndhm/fhir/r4/StructureDefinition/Practitioner\"] }, \"identifier\": [ { \"type\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\", \"code\": \"MD\", \"display\": \"Medical License number\" } ] }, \"system\": \"http://abdm.gov.in/facilities\", \"value\": \"DOC-123/456\" } ], \"name\": [ { \"text\": \"Dr Viswas kar\" } ] } } ] }', 'Approved', '{\"medical\": {\"status\": \"Approved\", \"remarks\": \"\"}, \"financial\": {\"status\": \"Approved\"}}', '1705661714568', '1705661715600', 'response.complete', 'c3e73251-dffb-446e-a028-e0748bd1abdd', '9620499129', 'Approved', 'e-ce224fd0b737', '1234', '1234', 'Approved', 'ABSP', '[ { \"documentType\" : \" \", \"urls\" : [\"http://123.com\", \"http://123.com\"  ] } ]', '987664543', 'ABCD1234', 'Abhishek', 'medical')");
      String requestBody = getRequestBodyClaims();
      MvcResult mvcResult = mockMvc.perform(post("/"+ api_version + "/claim/submit").content(requestBody).contentType(MediaType.APPLICATION_JSON)).andReturn();
      MockHttpServletResponse response = mvcResult.getResponse();
      System.out.println(response.getContentAsString());
      int status = response.getStatus();
      assertEquals(202, status);
  }

  @Test
  public void check_claim_on_submit_success_scenario() throws Exception {
      postgresService.execute("DROP TABLE IF EXISTS mock_participant");
      postgresService.execute("CREATE TABLE mock_participant (\n" +
              "    parent_participant_code character varying,\n" +
              "    child_participant_code character varying PRIMARY KEY,\n" +
              "    primary_email character varying,\n" +
              "    password character varying,\n" +
              "    private_key character varying\n" +
              ");");
      postgresService.execute("INSERT INTO mock_participant(parent_participant_code,child_participant_code,primary_email,password,private_key)"+"VALUES ('hosp_hcx_955522@swasth-hcx-dev ','payr_hcxmoc_903588@swasth-hcx-dev','lagertha+mock_payor@yopmail.com','Opensaber@123','-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDAQLG7dTHuSE1F 8L46wS84SCU4Pf+ofSB8/h8tlyUHCw2SmY3CRZ3Uz1Jtw87UCdEvaSqs4YvkdKIh 1Nt04xpunUufUYNx6wBx/S/nuG7zcUu+bQeO1SpeEAA6+4HvnAyVBc+YCctnyREr Pgigs8MJG6dMA2rEap1na8VTrVN6JNNhcJxqnCyMoZ/aJIrmRxMj0Eh55LC20AZh jkxt5q/12qarpc/0ItQ2nv11fucojVVQyQGBaeqULVM9fGXbtquLXnRLJWzTLuSN Zk3Z+NpZZ5W7gxyBsxGTc7ccWp5edOxMXK3wELxsqirT0EOIz2ZMEYVbWrCyxfGC WYGUGRkPAgMBAAECggEACRAjsMweDfcfmW/3b8qioLsZ8hROJJG9gdby/lG1P6dA PQx7F9DzV1BsuNr1uZ4628rP5bV+REdRS1n+/HwmR1en9HtBwJGNBFKkuv5BUL2j DfeS1yNqa2PCtwUbQ4HuP+o1tpujmKFsa0bx3i2LQLcqhFVW56qFABafB0pQ+J2F 5MIgoS3e84Q/4oHYhxcRCgINQRoWKkqLGdAMg83NGe/G97PHGW9PPG9AQnfVhqey adov6rO/VOhbEYoKIwBq4G2qFnq6GwxDsx+wKl7SMVIwJzk8lRd5IaCGNscGEirU f/1PKxRT5WR735wyFyqLtSATFlrvH+sIiKsYR0PRlQKBgQDewV/umGidbm4jcmYR PFW53Ipr05lz4VNUOxdI/NIQ5jNfwjTE7Ep4R2xWycgzFwtoYYzWOhgHfSEcQ7KH 4z7w5Oe5CO+NB9viTxsrRx/kc6KU5cr3iqYCQzu2IaaVL2n6a0dDWR1ZXSGckKCf RWENuPkU9BAMn5LqEbcxVkSp6wKBgQDc8e4tMef6jpX5i8UEtd3y0HE302I1opfM 7Sdl5KVYsTOcTVobYM3niRKGtaY26EP7JCI2D0rCGS/DpDmsf7v5uHD4pZ4whRGR uhj64NIzveG3goki/ZerFZTc83mBxcaSBg48XL2x4oy32d0YXRC5IqEZ5vAIo7JE PlOZgKZAbQKBgQCVlVN/XHc76NErGoIx5stGYTPOzqxIZbJYaMntKGFEGeG71yUq a+ZiOMwmx5+Zt0rg0EkL/rzuInfejBNSLyawC3cUCU0b7oAYy7hZ6owfFAvEYz9V 1ZQ/BrkNSDGeEtXe5LVZI3mS7fhJM9G4wpU26tTQ3kf8whec+UKEbgLz+wKBgH1H EG2/5nFDd/ZPMh9Bn9+WIRwuV3liAADKV5SG2No5X7I4iecMNLQcHM0VInHvsNwt 2NgeQ51a+qJL9AfDRaqK0kOqZM/OI/AlPRTDdWyxNdL/yRJ2CBGR4x6FT1gt9DHI DTpcu5KpinCUr7Co1FqlMAOn1mKPrvzS+kQHljzhAoGBAL2Ui1c/qrX9ezggR78D WTK8u4QkvSdOoSDVbOes1FYEExHWh8hvRfO4PLTzlK58MJJnWj9hgiMItWzI7Iic pOEsHqgNl19VjdtKEloRAe5HYuC0pTTNTXo7qhq/De1wPr/lM82jofNXzpSpDetU 43Q9DXQ5KNiBbsKedfkRhJdY\n-----END PRIVATE KEY-----')");
      String requestBody = getRequestBodyClaims();
      MvcResult mvcResult = mockMvc.perform(post("/"+ api_version + "/claim/on_submit").content(requestBody).contentType(MediaType.APPLICATION_JSON)).andReturn();
      MockHttpServletResponse response = mvcResult.getResponse();
      int status = response.getStatus();
      assertEquals(202, status);
  }

}